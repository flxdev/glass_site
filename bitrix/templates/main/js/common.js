function Menu(){var e=$(".js-menu"),t=$(".mob-menu"),n="active",i="menu-open";e.add(t).on("click",function(){if(!e.hasClass("anim")){if(e.addClass("anim"),t.toggleClass(n),e.hasClass(n))setTimeout(function(){e.removeClass(n)},400),conf.body.removeClass(i),window.__prevScrollTop&&window.scroll(0,window.__prevScrollTop),window.__prevScrollTop=null;else{var o=$(window).scrollTop();window.__prevScrollTop=o,e.addClass(n),conf.body.addClass(i),document.body.style.top=-o+"px",window.scroll(0,window.__prevScrollTop)}setTimeout(function(){e.removeClass("anim")},500)}}),$(".mob-menu-inner").click(function(e){e.stopPropagation()})}function scaleVideoContainer(){var e=$(".video-container").height()+5,t=parseInt(e)+"px";$(".homepage-hero-module").css("height",t)}function initBannerVideoSize(e){$(e).each(function(){$(this).data("height",$(this).height()),$(this).data("width",$(this).width())}),scaleBannerVideoSize(e)}function scaleBannerVideoSize(e){var t,n,i=$(".video-container").width(),o=$(".video-container").outerHeight()+5;$(e).each(function(){var e=$(this).data("height")/$(this).data("width");$(this).width(i),i<1e3&&(n=o,t=n/e,$(this).css({"margin-top":0,"margin-left":-(t-i)/2+"px"}),$(this).width(t).height(n)),$(".homepage-hero-module .video-container video").addClass("fadeIn animated")})}function SearchForm(e){var t=this;t.initEvents=function(){t.el.on("focus",t.iFocus),t.el.on("blur",function(e){$(e.relatedTarget).hasClass("search-submit")||t.iBlur()}),t.el.on("input",t.iInput),t.submit.on("click",t.initSubmit),t.reset.on("click",t.iReset),this.el.on("click",function(){var e=$(this);e.removeAttr("readonly"),setTimeout(function(){e.trigger("change click"),e.focus()},500)})},t.iInput=function(){t.iVal=$(this).val(),0!=t.iVal?(t.reset.addClass(t.def.resetClass),t.form.addClass(t.def.active),t.placeHold.hide()):(t.reset.removeClass(t.def.resetClass),t.form.removeClass(t.def.active),t.placeHold.show())},t.iFocus=function(){t.iVal=t.el.val(),t.parent.addClass(t.def.open),t.submit.attr("type","submit"),0!=t.iVal.length&&t.form.addClass(t.def.active)},t.iBlur=function(){t.iVal=t.el.val(),0==t.iVal.length&&(t.parent.removeClass(t.def.open),t.submit.attr("type","button"))},t.iReset=function(){t.reset.removeClass(t.def.resetClass),t.form.removeClass(t.def.active),t.submit.attr("type","button"),t.el.attr("value",""),t.el.val(""),t.el.focus(),t.placeHold.show()},t.initSubmit=function(){return"submit"!==t.submit.attr("type")?t.el.trigger("focus"):alert("Send form!"),!1},t.iDetected=function(e){0!=t.iVal.length&&(t.iFocus(),t.reset.addClass(t.def.resetClass),t.placeHold.hide())},t.generatePlaceeholder=function(){var e=document.createElement("span");e.classList.add("placeholder");var n=this.el.data("placeholder");e.textContent=n,$(e).insertAfter(this.el),t.placeHold=$(".placeholder")},t.init=function(){t.el=e,t.parent=t.el.parent(),t.iVal=t.el.val(),t.submit=t.parent.find(".search-submit"),t.reset=t.parent.find(".search-reset"),t.form=t.el.parents("form"),t.def={open:"open",resetClass:"show",active:"not-empty"},t.generatePlaceeholder(),t.iDetected(),t.initEvents()},e.length&&t.init()}function promoslider(){$(".js-promoslider").each(function(){var e=$(this),t=e.closest(".promo-slider"),n=e.find(".promo-slider-item"),i=t.find(".js-promo-link");e.on("init reInit afterChange",function(e,t,o,a){var s=n.filter(".slick-current"),r=s.data("href");i.attr("href",r)}),e.slick({accessibility:!1,lazyLoad:"progressive",arrows:!0,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,speed:1e3})})}function lazyImage(){function e(e){return new Promise(function(t,n){var i=new Image;i.src=e,i.onload=t,i.onerror=n})}function t(t){var n=t.dataset.src;if(n)return e(n).then(function(){i(t,n)})}function n(e){0===l&&c.disconnect(),e.forEach(function(e){e.intersectionRatio>0&&(l--,c.unobserve(e.target),t(e.target))})}function i(e,t){e.classList.add("js-image-handled"),e.classList.contains("bg")?e.style.backgroundImage="url("+t+")":e.src=t,e.classList.add("fade-in")}for(var o=document.querySelectorAll(".js-image"),a=[],s=0;s<o.length;s++)a.push(o[s]);var r={rootMargin:"0px 0px",threshold:.01},l=a.length,c=void 0;if("IntersectionObserver"in window){c=new IntersectionObserver(n,r);for(var s=0;s<l;s++){if(a[s].classList.contains("js-image-handled"))return;c.observe(a[s])}}else for(var s=0;s<l;s++)t(a[s])}function Parallax(e){$(window).on("scroll",function(){var t,n,i,o,a,s,r,l,c,d,u,f,h=$(window).scrollTop(),p=conf.body[0].scrollHeight,v={};e.each(function(){if(v={},t=$(this),u=t.data("axis")||"y",!t.length)return!1;f=conf.footer,n=t.parent(),i=n[0].getBoundingClientRect(),s=parseInt(t.data("speed"),10)/109||.08,r=parseInt(t.data("direction"),10)||1,o=n.offset().top,a=($(window).height()-i.height)/2,0>a&&h+i.top<=f.outerHeight()&&(a=0);var e=r;2==r&&(e=-1),l=Math.round((i.top-a)*s)*e,0===h?2==r&&(l=0):(c=p,d=$(window).height()+h,c-o-n.outerHeight()<=2&&(c-d)/c===0&&(l=0)),v[u]=l,TweenMax.to(t,.1,v)})})}function teamslider(){$(".js-team-slider").each(function(){var e=$(this),t=e.parent();e.slick({accessibility:!1,lazyLoad:"ondemand",arrows:!0,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!1,slidesToShow:1,slidesToScroll:1,appendArrows:t.find(".slider-nav"),prevArrow:conf.arnprevcontent,nextArrow:conf.arnextcontent})})}function moreslider(){$(".js-moreslider").each(function(){var e=$(this),t=e.parent();e.slick({accessibility:!1,arrows:!0,dots:!1,fade:!1,touchMove:!1,dragable:!1,infinite:!1,slidesToShow:e.hasClass("w3")?3:2,slidesToScroll:1,appendArrows:t.find(".slider-nav"),prevArrow:conf.arnprevcontent,nextArrow:conf.arnextcontent})})}function scrollAnimations(){inView.offset({top:0,bottom:100}),inView.threshold(.25);document.querySelectorAll(".anim-cont");inView(".anim-cont").on("enter",function(e){e.done||e.classList.add("active")}).on("exit",function(e){e.done=!0}),inView(".projects-wrap").on("enter",function(e){e.done||(e.classList.add("active"),setTimeout(function(){tabs.init()},300))}).on("exit",function(e){e.done=!0})}function tabsanim(e){this.wrap=e,this.opts={act:"active",off:"off",timer:4500},this.current,this.interval,this.findElems()}function slided(e){this.wrap=$(e),this.opts={act:"active",slide:".carousel_layout-item",vsisibliSlides:":nth-child(-n+3)",layout:".carousel_layout",btn:".carousel_navi",btnspin:"spin"},this.findElems()}function stickinit(){setTimeout(function(){$(".js-stick").stick_in_parent({parent:".js-stick-parent",offset_top:140})},1)}function ProdinnerHead(){function e(){var e=$(window).scrollTop();e>n?t.addClass("active"):t.removeClass("active")}var t=$(".js-prod-head"),n=$(".page-head").height();$(window).on("scroll",debounce(e))}function returnStickPos(e,t){var n=$(window).scrollTop(),i=parseInt(t);e.height();"fixed"==e.css("position")&&e.css("top",n+i-80)}$(window).on("load",function(){lazyImage()}),document.addEventListener("DOMContentLoaded",function(){function e(){$(".video-container").length&&(scaleVideoContainer(),initBannerVideoSize(".video-container .poster img"),initBannerVideoSize(".video-container .filter"),initBannerVideoSize(".video-container video"),$(window).on("resize",function(){scaleVideoContainer(),scaleBannerVideoSize(".video-container .poster img"),scaleBannerVideoSize(".video-container .filter"),scaleBannerVideoSize(".video-container video")}))}Menu();new SearchForm($(".js-input"));promoslider(),e(),$(".js-parallax").length&&Parallax($(".js-parallax")),teamslider(),scrollAnimations()});var conf={body:$("body"),html:$("html"),hidden:"is-hidden",main:$("#barba-wrapper"),wrpr:$(".block"),footer:$(".footer"),arnextcontent:'<button type="button" class="slick-next slick-arrow"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.5 40.1"><style>.starrs0{fill:#1E3E7C;}</style><path d="M4.6 20.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.2.1-.3L19.3 2.6l-.2-.2.2.2c.2-.2.2-.4.2-.6 0-.3-.1-.6-.3-.7L18 .3c-.2-.2-.4-.3-.6-.3-.3 0-.6.1-.7.3L.2 19.4c-.1.2-.2.4-.2.7 0 .2.1.5.2.6l16.4 19.1c.2.2.5.3.7.3.2 0 .5-.1.6-.2l1.2-1c.2-.2.3-.5.3-.7 0-.2-.1-.5-.2-.6L4.6 20.4z" class="starrs0"/></svg></div></button>',arnprevcontent:'<button type="button" class="slick-prev slick-arrow"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.5 40.1"><style>.starrs0{fill:#1E3E7C;}</style><path d="M4.6 20.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.2.1-.3L19.3 2.6l-.2-.2.2.2c.2-.2.2-.4.2-.6 0-.3-.1-.6-.3-.7L18 .3c-.2-.2-.4-.3-.6-.3-.3 0-.6.1-.7.3L.2 19.4c-.1.2-.2.4-.2.7 0 .2.1.5.2.6l16.4 19.1c.2.2.5.3.7.3.2 0 .5-.1.6-.2l1.2-1c.2-.2.3-.5.3-.7 0-.2-.1-.5-.2-.6L4.6 20.4z" class="starrs0"/></svg></div></button>'};window.Promise||(window.Promise=Promise),function(){return"function"!=typeof NodeList.prototype.forEach&&void(NodeList.prototype.forEach=Array.prototype.forEach)}(),tabsanim.prototype={findElems:function(){this.triggers=this.wrap.querySelectorAll(".js-tabs-trigger"),this.conts=this.wrap.querySelectorAll(".js-tabs-item"),this.lines=this.wrap.querySelectorAll(".tabs-item-line"),$(this.lines).css("transition-duration",this.opts.timer+"ms"),this.iLen=this.triggers.length},init:function(){var e=this.triggers[0];this.current=e,this.toggleTab(e),this.initNext(),this.initClick(),this.wrap.classList.add("inited")},toggleTab:function(e){var t=this;$(this.triggers).removeClass(t.opts.act);var n=parseInt(e.getAttribute("data-id"));e.classList.add(t.opts.act),$(this.conts).removeClass(t.opts.act),this.conts.forEach(function(e,i){t.conts[i].getAttribute("data-id")==n&&t.conts[i].classList.add(t.opts.act)}),clearInterval(t.interval),this.moveInterval()},initClick:function(){var e=this;this.triggers.forEach(function(t,n){e.triggers[n].addEventListener("click",function(){var t=this;t.classList.contains(e.opts.act)||t.classList.contains(e.opts.off)||(e.toggleTab(t),e.preventClick(),e.current=t)})})},preventClick:function(){var e=this;this.triggers.forEach(function(t,n){e.triggers[n].classList.add("off"),setTimeout(function(){e.triggers[n].classList.remove("off")},800)})},initNext:function(){this.triggersArray=Array.prototype.slice.apply(this.triggers),this.moveInterval()},moveInterval:function(){var e=this;clearTimeout(e.interval),this.interval=setTimeout(function(){curInd=e.triggersArray.indexOf(e.current),curInd<e.iLen-1?(e.current=e.triggers[curInd+1],e.toggleTab(e.current)):(e.current=e.triggers[0],e.toggleTab(e.current))},e.opts.timer)}},slided.prototype={findElems:function(){var e=this;this.wrap.each(function(){var t=$(this);t.slides=t.find(e.opts.slide),t.btn=t.find(e.opts.btn),1===t.slides.length&&t.btn.hide(),e.initialize(t,t.slides,t.btn)})},initialize:function(e,t,n){TweenLite.set(t.not(this.opts.vsisibliSlides),{autoAlpha:0});var i=t.filter(".active"),o=new TimelineLite;o.set(i,{x:"0",transformOrigin:"left 50%"}).set(i.next(),{x:"-3%",scaleX:.92,scaleY:.92,transformOrigin:"left 50%"}).set(i.next().next(),{x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%"}).set(i.next().next().next(),{x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%"}),this.initclick(e,n)},initclick:function(e,t){function n(){var e=$(this);e.addClass("hovered"),e.on("mouseleave",function(){e.removeClass("hovered")})}var i=this;t.on("click",function(n){n.preventDefault();var o=$(this);if(o.hasClass("animate"))return!1;o.addClass("animate"),o.addClass("spin"),setTimeout(function(){o.removeClass("spin")},500);var a=e.find(".active"),s=(e.find(i.opts.slide),a.next()),r=s.next(),l=r.next();i.refreshSlide(e,t,a,s,r,l)});var o=e.closest(".prod-elem");o.on("mouseenter",n)},refreshSlide:function(e,t,n,i,o,a){var s=this,r=new TimelineLite({onComplete:function(){var n=e.find(".active");s.circleSlide(e,n,t,i,o,a)}});r.set(n,{x:"0",autoAlpha:1,scaleX:1,scaleY:1,className:"-=active",zIndex:3}).set(i,{x:"-3%",scaleX:.92,scaleY:.92,className:"+=active",zIndex:2}).set(o,{x:"-5%",scaleX:.85,scaleY:.85,zIndex:1}).set(a,{autoAlpha:0,x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%",zIndex:0}).to(n,1,{x:"0",autoAlpha:0,scaleX:1.1,scaleY:1.1,ease:Power3.easeInOut},0).to(i,1,{x:"+=3%",scaleX:1,scaleY:1,ease:Power3.easeInOut},0).to(o,1,{x:"+=2%",scaleX:.92,scaleY:.92,ease:Power3.easeInOut},0).to(a,1,{autoAlpha:1,ease:Power3.easeInOut},0)},circleSlide:function(e,t,n,i,o,a){var s=this,r=e.find(s.opts.slide),l=t,c=l.parent(),d=new TimelineLite;l.prev().detach().appendTo(c),2===r.length?d.set(r,{x:"0",transformOrigin:"left 50%",zIndex:3}).set(r.next(),{x:"-3%",scaleX:.92,scaleY:.92,transformOrigin:"left 50%",zIndex:1}).to(r.next(),.2,{autoAlpha:1,ease:Power3.easeInOut},0):3===r.length?d.set(r,{x:"0",transformOrigin:"left 50%",zIndex:3}).set(r.next(),{x:"-3%",scaleX:.92,scaleY:.92,transformOrigin:"left 50%",zIndex:2}).set(r.next().next(),{x:"-5%",scaleX:.85,scaleY:.85,zIndex:1}).to(r.next(),.2,{autoAlpha:1,ease:Power3.easeInOut},0):d.set(r.last(),{x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%",zIndex:0}),n.removeClass("animate")}};var debounce=function(e,t,n){var i;return function(){var o=this,a=arguments,s=function(){i=null,n||e.apply(o,a)},r=n&&!i;clearTimeout(i),i=setTimeout(s,t),r&&e.apply(o,a)}},sortItem=function(){var e=$(".js-select-item");e.each(function(){var t=$(this),n=t.find(".js-trgt-text"),i=t.parent().find(".dropdown-target"),o=i.find(".sort-select-item a");t.on("click",function(){e.removeClass("active"),t.toggleClass("active")}),o.each(function(){var t=$(this);t.on("click",function(o){var a=t.data("text");n.text(a),t.parent().addClass("active").siblings().removeClass("active"),o.preventDefault(),setTimeout(function(){i.removeClass("active"),e.removeClass("active")},300)})}),$(document).on("mouseup",function(t){e.is(t.target)||0!==e.has(t.target).length||e.removeClass("active")})})},BarbaWitget={init:function(){var e=this;Barba.Pjax.start(),Barba.Pjax.getTransition=function(){return e.MovePage},Barba.Dispatcher.on("newPageReady",function(e,t,n){}),Barba.Dispatcher.on("transitionCompleted",function(e,t){lazyImage(),$(".js-parallax").length&&Parallax($(".js-parallax")),scrollAnimations()})},MovePage:Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){Barba.Utils.deferred();return $(this.oldContainer).animate({opacity:0},1e3).addClass("moveDown").promise()},fadeIn:function(){var e=this,t=$(this.newContainer);$(this.oldContainer).hide(),t.addClass("moveUp"),TweenMax.set(t,{y:200,position:"absolute",left:0,top:0,right:0}),$(window).scrollTop(0,0),TweenMax.to(t,.5,{y:0,autoAlpha:1,onComplete:function(){TweenMax.set(t,{clearProps:"all"}),t.removeClass("moveUp"),e.done()}})}})},IndexPage=Barba.BaseView.extend({namespace:"index",onEnter:function(){promoslider();var e=document.querySelector(".js-tabs-cont");tabs=new tabsanim(e),teamslider()},onEnterCompleted:function(){},onLeaveComplete:function(){delete tabs}}),Production=Barba.BaseView.extend({namespace:"Production",onEnter:function(){var e=document.querySelectorAll(".carousel_layout-container");e=new slided(e)},onEnterCompleted:function(){console.log("onEnterCompleted")},onLeaveComplete:function(){console.log("onLeaveComplete")}}),ProductionInner=Barba.BaseView.extend({namespace:"Production-inner",onEnter:function(){},onLeave:function(){var e=$(".js-stick"),t=e.css("top");"auto"!=t&&returnStickPos(e,t)},onEnterCompleted:function(){ProdinnerHead(),stickinit(),moreslider()},onLeaveComplete:function(){}}),PojectsPage=Barba.BaseView.extend({namespace:"Projects",onEnter:function(){},onEnterCompleted:function(){sortItem()},onLeaveComplete:function(){}});IndexPage.init(),Production.init(),ProductionInner.init(),PojectsPage.init(),BarbaWitget.init();