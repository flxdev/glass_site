function Menu(){var e=$(".js-menu"),t=$(".mob-menu"),i="active",n="menu-open";e.add(t).on("click",function(){if(!e.hasClass("anim")){if(e.addClass("anim"),t.toggleClass(i),e.hasClass(i))setTimeout(function(){e.removeClass(i)},400),conf.body.removeClass(n),window.__prevScrollTop&&window.scroll(0,window.__prevScrollTop),window.__prevScrollTop=null;else{var a=$(window).scrollTop();window.__prevScrollTop=a,e.addClass(i),conf.body.addClass(n),document.body.style.top=-a+"px",window.scroll(0,window.__prevScrollTop)}setTimeout(function(){e.removeClass("anim")},500)}}),$(".mob-menu-inner").click(function(e){e.stopPropagation()})}function scaleVideoContainer(){var e=$(".video-container").height()+5,t=parseInt(e)+"px";$(".homepage-hero-module").css("height",t)}function initBannerVideoSize(e){$(e).each(function(){$(this).data("height",$(this).height()),$(this).data("width",$(this).width())}),scaleBannerVideoSize(e)}function scaleBannerVideoSize(e){var t,i,n=$(".video-container").width(),a=$(".video-container").outerHeight()+5;$(e).each(function(){var e=$(this).data("height")/$(this).data("width");$(this).width(n),n<1e3&&(i=a,t=i/e,$(this).css({"margin-top":0,"margin-left":-(t-n)/2+"px"}),$(this).width(t).height(i)),$(".homepage-hero-module .video-container video").addClass("fadeIn animated")})}function SearchForm(e){var t=this;t.initEvents=function(){t.el.on("focus",t.iFocus),t.el.on("blur",function(e){$(e.relatedTarget).hasClass("search-submit")||t.iBlur()}),t.el.on("input",t.iInput),t.submit.on("click",t.initSubmit),t.reset.on("click",t.iReset),this.el.on("click",function(){var e=$(this);e.removeAttr("readonly"),setTimeout(function(){e.trigger("change click"),e.focus()},500)})},t.iInput=function(){t.iVal=$(this).val(),0!=t.iVal?(t.reset.addClass(t.def.resetClass),t.form.addClass(t.def.active),t.placeHold.hide()):(t.reset.removeClass(t.def.resetClass),t.form.removeClass(t.def.active),t.placeHold.show())},t.iFocus=function(){t.iVal=t.el.val(),t.parent.addClass(t.def.open),t.submit.attr("type","submit"),0!=t.iVal.length&&t.form.addClass(t.def.active)},t.iBlur=function(){t.iVal=t.el.val(),0==t.iVal.length&&(t.parent.removeClass(t.def.open),t.submit.attr("type","button"))},t.iReset=function(){t.reset.removeClass(t.def.resetClass),t.form.removeClass(t.def.active),t.submit.attr("type","button"),t.el.attr("value",""),t.el.val(""),t.el.focus(),t.placeHold.show()},t.initSubmit=function(){return"submit"!==t.submit.attr("type")?t.el.trigger("focus"):alert("Send form!"),!1},t.iDetected=function(e){0!=t.iVal.length&&(t.iFocus(),t.reset.addClass(t.def.resetClass),t.placeHold.hide())},t.generatePlaceeholder=function(){var e=document.createElement("span");e.classList.add("placeholder");var i=this.el.data("placeholder");e.textContent=i,$(e).insertAfter(this.el),t.placeHold=$(".placeholder")},t.init=function(){t.el=e,t.parent=t.el.parent(),t.iVal=t.el.val(),t.submit=t.parent.find(".search-submit"),t.reset=t.parent.find(".search-reset"),t.form=t.el.parents("form"),t.def={open:"open",resetClass:"show",active:"not-empty"},t.generatePlaceeholder(),t.iDetected(),t.initEvents()},e.length&&t.init()}function promoslider(){$(".js-promoslider").each(function(){var e=$(this),t=e.closest(".promo-slider"),i=e.find(".promo-slider-item"),n=t.find(".js-promo-link");e.on("init reInit afterChange",function(e,t,a,o){var s=i.filter(".slick-current"),r=s.data("href");n.attr("href",r)}),e.slick({accessibility:!1,lazyLoad:"progressive",arrows:!0,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,speed:1e3})})}function lazyImage(){function e(e){return new Promise(function(t,i){var n=new Image;n.src=e,n.onload=t,n.onerror=i})}function t(t){var i=t.dataset.src;if(i)return e(i).then(function(){n(t,i)})}function i(e){0===l&&c.disconnect(),e.forEach(function(e){e.intersectionRatio>0&&(l--,c.unobserve(e.target),t(e.target))})}function n(e,t){e.classList.add("js-image-handled"),e.classList.contains("bg")?e.style.backgroundImage="url("+t+")":e.src=t,e.classList.add("fade-in")}for(var a=document.querySelectorAll(".js-image"),o=[],s=0;s<a.length;s++)o.push(a[s]);var r={rootMargin:"0px 0px",threshold:.01},l=o.length,c=void 0;if("IntersectionObserver"in window){c=new IntersectionObserver(i,r);for(var s=0;s<l;s++){if(o[s].classList.contains("js-image-handled"))return;c.observe(o[s])}}else for(var s=0;s<l;s++)t(o[s])}function Parallax(e){$(window).on("scroll",function(){var t,i,n,a,o,s,r,l,c,d,u,f,h=$(window).scrollTop(),p=conf.body[0].scrollHeight,m={};e.each(function(){if(m={},t=$(this),u=t.data("axis")||"y",!t.length)return!1;f=conf.footer,i=t.parent(),n=i[0].getBoundingClientRect(),s=parseInt(t.data("speed"),10)/109||.08,r=parseInt(t.data("direction"),10)||1,a=i.offset().top,o=($(window).height()-n.height)/2,0>o&&h+n.top<=f.outerHeight()&&(o=0);var e=r;2==r&&(e=-1),l=Math.round((n.top-o)*s)*e,0===h?2==r&&(l=0):(c=p,d=$(window).height()+h,c-a-i.outerHeight()<=2&&(c-d)/c===0&&(l=0)),m[u]=l,TweenMax.to(t,.1,m)})})}function teamslider(){$(".js-team-slider").each(function(){var e=$(this),t=e.parent();e.slick({accessibility:!1,lazyLoad:"ondemand",arrows:!0,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!1,slidesToShow:1,slidesToScroll:1,appendArrows:t.find(".slider-nav"),prevArrow:conf.arnprevcontent,nextArrow:conf.arnextcontent})})}function scrollAnimations(){console.log("scrollAnimations init"),inView.offset({top:0,bottom:100}),inView.threshold(.25);document.querySelectorAll(".anim-cont");inView(".anim-cont").on("enter",function(e){e.done||e.classList.add("active")}).on("exit",function(e){e.done=!0}),inView(".projects-wrap").on("enter",function(e){e.done||(e.classList.add("active"),setTimeout(function(){tabs.init()},300))}).on("exit",function(e){e.done=!0})}function tabsanim(e){this.wrap=e,this.opts={act:"active",off:"off",timer:4500},this.current,this.interval,this.findElems()}function slided(e){this.wrap=$(e),this.opts={act:"active",slide:".carousel_layout-item",vsisibliSlides:":nth-child(-n+3)",layout:".carousel_layout",btn:".carousel_navi",btnspin:"spin"},this.findElems()}$(window).on("load",function(){lazyImage()}),document.addEventListener("DOMContentLoaded",function(){function e(){$(".video-container").length&&(scaleVideoContainer(),initBannerVideoSize(".video-container .poster img"),initBannerVideoSize(".video-container .filter"),initBannerVideoSize(".video-container video"),$(window).on("resize",function(){scaleVideoContainer(),scaleBannerVideoSize(".video-container .poster img"),scaleBannerVideoSize(".video-container .filter"),scaleBannerVideoSize(".video-container video")}))}Menu();new SearchForm($(".js-input"));promoslider(),e(),$(".js-parallax").length&&Parallax($(".js-parallax")),teamslider(),scrollAnimations()});var conf={body:$("body"),html:$("html"),hidden:"is-hidden",main:$("#barba-wrapper"),wrpr:$(".block"),footer:$(".footer"),arnextcontent:'<button type="button" class="slick-next slick-arrow"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.5 40.1"><style>.starrs0{fill:#1E3E7C;}</style><path d="M4.6 20.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.2.1-.3L19.3 2.6l-.2-.2.2.2c.2-.2.2-.4.2-.6 0-.3-.1-.6-.3-.7L18 .3c-.2-.2-.4-.3-.6-.3-.3 0-.6.1-.7.3L.2 19.4c-.1.2-.2.4-.2.7 0 .2.1.5.2.6l16.4 19.1c.2.2.5.3.7.3.2 0 .5-.1.6-.2l1.2-1c.2-.2.3-.5.3-.7 0-.2-.1-.5-.2-.6L4.6 20.4z" class="starrs0"/></svg></div></button>',arnprevcontent:'<button type="button" class="slick-prev slick-arrow"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.5 40.1"><style>.starrs0{fill:#1E3E7C;}</style><path d="M4.6 20.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.2.1-.3L19.3 2.6l-.2-.2.2.2c.2-.2.2-.4.2-.6 0-.3-.1-.6-.3-.7L18 .3c-.2-.2-.4-.3-.6-.3-.3 0-.6.1-.7.3L.2 19.4c-.1.2-.2.4-.2.7 0 .2.1.5.2.6l16.4 19.1c.2.2.5.3.7.3.2 0 .5-.1.6-.2l1.2-1c.2-.2.3-.5.3-.7 0-.2-.1-.5-.2-.6L4.6 20.4z" class="starrs0"/></svg></div></button>'};window.Promise||(window.Promise=Promise),function(){return"function"!=typeof NodeList.prototype.forEach&&void(NodeList.prototype.forEach=Array.prototype.forEach)}(),tabsanim.prototype={findElems:function(){this.triggers=this.wrap.querySelectorAll(".js-tabs-trigger"),this.conts=this.wrap.querySelectorAll(".js-tabs-item"),this.lines=this.wrap.querySelectorAll(".tabs-item-line"),$(this.lines).css("transition-duration",this.opts.timer+"ms"),this.iLen=this.triggers.length},init:function(){var e=this.triggers[0];this.current=e,this.toggleTab(e),this.initNext(),this.initClick(),this.wrap.classList.add("inited")},toggleTab:function(e){var t=this;$(this.triggers).removeClass(t.opts.act);var i=parseInt(e.getAttribute("data-id"));e.classList.add(t.opts.act),$(this.conts).removeClass(t.opts.act),t.conts.forEach(function(e,n){t.conts[n].getAttribute("data-id")==i&&t.conts[n].classList.add(t.opts.act)}),clearInterval(t.interval),this.moveInterval()},initClick:function(){var e=this;e.triggers.forEach(function(t,i){e.triggers[i].addEventListener("click",function(){var t=this;t.classList.contains(e.opts.act)||t.classList.contains(e.opts.off)||(e.toggleTab(t),e.preventClick(),e.current=t)})})},preventClick:function(){var e=this;e.triggers.forEach(function(t,i){e.triggers[i].classList.add("off"),setTimeout(function(){e.triggers[i].classList.remove("off")},800)})},initNext:function(){var e=this;this.triggersArray=Array.prototype.slice.apply(this.triggers),e.moveInterval()},moveInterval:function(){var e=this;clearTimeout(e.interval),e.interval=setTimeout(function(){curInd=e.triggersArray.indexOf(e.current),curInd<e.iLen-1?(e.current=e.triggers[curInd+1],e.toggleTab(e.current)):(e.current=e.triggers[0],e.toggleTab(e.current))},e.opts.timer)}},slided.prototype={findElems:function(){var e=this;this.wrap.each(function(){var t=$(this);t.slides=t.find(e.opts.slide),t.btn=t.find(e.opts.btn),1===t.slides.length&&t.btn.hide(),e.initialize(t,t.slides,t.btn)})},initialize:function(e,t,i){TweenLite.set(t.not(this.opts.vsisibliSlides),{autoAlpha:0});var n=t.filter(".active"),a=new TimelineLite;a.set(n,{x:"0",transformOrigin:"left 50%"}).set(n.next(),{x:"-3%",scaleX:.92,scaleY:.92,transformOrigin:"left 50%"}).set(n.next().next(),{x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%"}).set(n.next().next().next(),{x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%"}),this.initclick(e,i)},initclick:function(e,t){var i=this;t.on("click",function(){var n=$(this);if(n.hasClass("animate"))return!1;n.addClass("animate"),n.addClass("spin"),setTimeout(function(){n.removeClass("spin")},600);var a=e.find(".active"),o=(e.find(i.opts.slide),a.next()),s=o.next(),r=s.next();i.refreshSlide(e,t,a,o,s,r)})},refreshSlide:function(e,t,i,n,a,o){var s=this,r=new TimelineLite({onComplete:function(){var i=e.find(".active");s.circleSlide(e,i,t,n,a,o)}});r.set(i,{x:"0",autoAlpha:1,scaleX:1,scaleY:1,className:"-=active",zIndex:3}).set(n,{x:"-3%",scaleX:.92,scaleY:.92,className:"+=active",zIndex:2}).set(a,{x:"-5%",scaleX:.85,scaleY:.85,zIndex:1}).set(o,{autoAlpha:0,x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%",zIndex:0}).to(i,1,{x:"0",autoAlpha:0,scaleX:1.1,scaleY:1.1,ease:Power3.easeInOut},0).to(n,1,{x:"+=3%",scaleX:1,scaleY:1,ease:Power3.easeInOut},0).to(a,1,{x:"+=2%",scaleX:.92,scaleY:.92,ease:Power3.easeInOut},0).to(o,1,{autoAlpha:1,ease:Power3.easeInOut},0)},circleSlide:function(e,t,i,n,a,o){var s=this,r=e.find(s.opts.slide),l=t,c=l.parent(),d=new TimelineLite;l.prev().detach().appendTo(c),2===r.length?d.set(r,{x:"0",transformOrigin:"left 50%",zIndex:3}).set(r.next(),{x:"-3%",scaleX:.92,scaleY:.92,transformOrigin:"left 50%",zIndex:1}).to(r.next(),.2,{autoAlpha:1,ease:Power3.easeInOut},0):3===r.length?d.set(r,{x:"0",transformOrigin:"left 50%",zIndex:3}).set(r.next(),{x:"-3%",scaleX:.92,scaleY:.92,transformOrigin:"left 50%",zIndex:2}).set(r.next().next(),{x:"-5%",scaleX:.85,scaleY:.85,zIndex:1}).to(r.next(),.2,{autoAlpha:1,ease:Power3.easeInOut},0):d.set(r.last(),{x:"-5%",scaleX:.85,scaleY:.85,transformOrigin:"left 50%",zIndex:0}),i.removeClass("animate")}};var debounce=function(e,t,i){var n;return function(){var a=this,o=arguments,s=function(){n=null,i||e.apply(a,o)},r=i&&!n;clearTimeout(n),n=setTimeout(s,t),r&&e.apply(a,o)}},BarbaWitget={init:function(){var e=this;Barba.Pjax.start(),Barba.Pjax.getTransition=function(){return e.MovePage},Barba.Dispatcher.on("newPageReady",function(e,t,i){scrollAnimations(),$(".js-parallax").length&&Parallax($(".js-parallax"))}),Barba.Dispatcher.on("transitionCompleted",function(e,t){lazyImage()})},MovePage:Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){Barba.Utils.deferred();return $(this.oldContainer).animate({opacity:0},500).promise()},fadeIn:function(){var e=this,t=$(this.newContainer);$(window).scrollTop(0,0),$(this.oldContainer).hide(),$(this.newContainer).hide(),this.newContainer.style.visibility="visible",t.fadeIn({duration:500,complete:function(){e.done()}})}})},IndexPage=Barba.BaseView.extend({namespace:"index",onEnter:function(){promoslider();var e=document.querySelector(".js-tabs-cont");tabs=new tabsanim(e),teamslider()},onEnterCompleted:function(){},onLeaveComplete:function(){delete tabs}}),Production=Barba.BaseView.extend({namespace:"Production",onEnter:function(){var e=document.querySelectorAll(".carousel_layout-container");e=new slided(e)},onEnterCompleted:function(){console.log("onEnterCompleted")},onLeaveComplete:function(){console.log("onLeaveComplete")}});IndexPage.init(),Production.init(),BarbaWitget.init();